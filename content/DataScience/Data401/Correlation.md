---
title: 
draft: false
tags:
---
# Correlation 详解

相关性（Correlation）是统计学中用来衡量两个变量之间关系的一种指标。它描述了两个变量在多大程度上以及以何种方式共同变化。相关性可以帮助我们理解变量之间的依赖性和预测关系。

## 相关系数

相关性的常用指标是相关系数，通常取值在 -1 和 1 之间：

- **1** 表示完全正相关：当一个变量增加时，另一个变量也以线性方式增加。
- **0** 表示无相关性：两个变量之间没有线性关系。
- **-1** 表示完全负相关：当一个变量增加时，另一个变量以线性方式减少。

需要注意的是，相关系数仅衡量线性关系，如果两个变量之间存在非线性关系，相关系数可能无法准确反映其依赖性。

## 常用的相关系数

### 1. 皮尔逊相关系数（Pearson Correlation Coefficient）

- 计算线性关系的强度和方向。
- 公式：

$$
r = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i - \bar{x})^2 \sum (y_i - \bar{y})^2}}
$$

- 要求：变量之间是线性关系，并且数据是连续的和正态分布的。

### 2. 斯皮尔曼秩相关系数（Spearman's Rank Correlation Coefficient）

- 计算两个变量的秩序关系，不要求线性关系。
- 公式：

$$
r_s = 1 - \frac{6 \sum d_i^2}{n(n^2 - 1)}
$$

其中 $d_i$ 是两个变量的秩之差，$n$ 是样本数量。

### 3. 肯德尔秩相关系数（Kendall's Tau Coefficient）

- 衡量两个变量秩序关系的一致性。
- 公式：

$$
\tau = \frac{(C - D)}{\sqrt{(C + D + T)(C + D + U)}}
$$

其中 $C$ 是一致对，$D$ 是不一致对，$T$ 和 $U$ 是重复值的对数。

## 计算步骤

以皮尔逊相关系数为例，计算步骤如下：

1. 计算每个变量的均值 $\bar{x}$ 和 $\bar{y}$。
2. 计算每个数据点的偏差 $(x_i - \bar{x})$ 和 $(y_i - \bar{y})$。
3. 计算偏差的乘积和 $\sum (x_i - \bar{x})(y_i - \bar{y})$。
4. 计算每个变量的偏差平方和 $\sum (x_i - \bar{x})^2$ 和 $\sum (y_i - \bar{y})^2$。
5. 代入公式计算相关系数 $r$。

## 示例

假设有以下数据：

| x  | y  |
|----|----|
| 1  | 2  |
| 2  | 3  |
| 3  | 5  |
| 4  | 4  |
| 5  | 6  |

计算皮尔逊相关系数：

1. 计算均值：
   $$
   \bar{x} = \frac{1 + 2 + 3 + 4 + 5}{5} = 3
   $$
   $$
   \bar{y} = \frac{2 + 3 + 5 + 4 + 6}{5} = 4
   $$

2. 计算偏差：
   $$
   (x_i - \bar{x}) = [-2, -1, 0, 1, 2]
   $$
   $$
   (y_i - \bar{y}) = [-2, -1, 1, 0, 2]
   $$

3. 计算偏差乘积和：
   $$
   \sum (x_i - \bar{x})(y_i - \bar{y}) = (-2 \cdot -2) + (-1 \cdot -1) + (0 \cdot 1) + (1 \cdot 0) + (2 \cdot 2) = 4 + 1 + 0 + 0 + 4 = 9
   $$

4. 计算 $x$ 的偏差平方和：
   $$
   \sum (x_i - \bar{x})^2 = (-2)^2 + (-1)^2 + 0^2 + 1^2 + 2^2 = 4 + 1 + 0 + 1 + 4 = 10
   $$

5. 计算 $y$ 的偏差平方和：
   $$
   \sum (y_i - \bar{y})^2 = (-2)^2 + (-1)^2 + 1^2 + 0^2 + 2^2 = 4 + 1 + 1 + 0 + 4 = 10
   $$

6. 计算相关系数：
   $$
   r = \frac{9}{\sqrt{10 \cdot 10}} = \frac{9}{10} = 0.9
   $$

## Python 代码示例

```python
import numpy as np

# 数据点
x = np.array([1, 2, 3, 4, 5])
y = np.array([2, 3, 5, 4, 6])

# 计算皮尔逊相关系数
correlation = np.corrcoef(x, y)[0, 1]

print(f'Pearson correlation coefficient: {correlation}')
```

